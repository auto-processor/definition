---
- name: Create transactor
  hosts: localhost
  connection: local

  tasks:
    - name: Include vars of config.yaml.
      include_vars:
        file: ./../config.yaml
      no_log: True

    - name: Download Datomic pro
      get_url:
        url: 'https://my.datomic.com/repo/com/datomic/datomic-pro/{{ version }}/datomic-pro-{{ version }}.zip'
        dest: './../datomic-pro-{{ version }}.zip'
        username: '{{ datomic_username }}'
        password: '{{ datomic_password }}'
      no_log: True

    - name: Extract datomic pro into
      ansible.builtin.unarchive:
        src: './../datomic-pro-{{ version }}.zip'
        dest: ./../

    #- name: Remove zip
      #ansible.builtin.file:
        #path: './../datomic-pro-{{ version }}.zip'
        #state: absent

    - name: Template ddb to ddb-transactor.properties
      ansible.builtin.template:
        src: ./../templates/ddb-transactor-template.j2
        dest: ./../ddb-transactor.properties
        mode: '0644'

